<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Eléctrica Avanzada</title>
<style>
    :root {
        --bg-color: #000000;
        --text-color: #ffffff;
        --button-bg: #333333;
        --button-hover: #444444;
        --button-active: #555555;
        --display-bg: #111111;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }

    .calculator {
        background-color: var(--bg-color);
        border-radius: 10px;
        padding: 20px;
        width: 350px;
    }

    .display {
        background-color: var(--display-bg);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
        min-height: 200px;
        position: relative;
        overflow: hidden;
    }

    .previous-value, .current-value, .result-label {
        margin: 5px 0;
        word-wrap: break-word;
    }

    .previous-value {
        font-size: 14px;
        color: #888;
    }

    .current-value {
        font-size: 24px;
        font-weight: bold;
    }

    .result-label {
        font-size: 16px;
        color: #aaa;
    }

    .steps {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: var(--display-bg);
        padding: 10px;
        overflow-y: auto;
        font-size: 14px;
    }

    .buttons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
    }

    .button {
        background-color: var(--button-bg);
        border: none;
        color: var(--text-color);
        padding: 15px;
        font-size: 18px;
        cursor: pointer;
        border-radius: 50%;
        transition: background-color 0.3s;
        width: 60px;
        height: 60px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .button:hover {
        background-color: var(--button-hover);
    }

    .button:active {
        background-color: var(--button-active);
    }

    .dropdown {
        position: relative;
        display: inline-block;
        width: 100%;
        margin-bottom: 10px;
    }

    .dropbtn {
        background-color: var(--button-bg);
        color: var(--text-color);
        padding: 10px;
        font-size: 16px;
        border: none;
        cursor: pointer;
        width: 100%;
        text-align: left;
        border-radius: 30px;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: var(--button-bg);
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1;
        width: 100%;
        border-radius: 15px;
        overflow: hidden;
    }

    .dropdown-content button {
        color: var(--text-color);
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        background: none;
        border: none;
        width: 100%;
        text-align: left;
        cursor: pointer;
    }

    .dropdown-content button:hover {
        background-color: var(--button-hover);
    }

    .show {
        display: block;
    }

    .mode-buttons {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
    }

    .mode-button {
        background-color: var(--button-bg);
        color: var(--text-color);
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        border-radius: 30px;
        transition: background-color 0.3s;
        flex: 1;
        margin: 0 5px;
    }

    .mode-button:hover {
        background-color: var(--button-hover);
    }

    .mode-button.active {
        background-color: var(--button-active);
    }
</style>
</head>
<body>
<div class="calculator">
    <div class="mode-buttons">
        <button class="mode-button active" onclick="setMode('basic')">C.B</button>
        <button class="mode-button" onclick="setMode('advanced')">C.A</button>
    </div>

    <div id="basicModeDropdown" class="dropdown">
        <button onclick="toggleDropdown('basicSubModeDropdown')" class="dropbtn">Submodo: <span id="currentBasicSubMode">Resistencia</span></button>
        <div id="basicSubModeDropdown" class="dropdown-content">
            <button onclick="setSubMode('resistance')">Resistencia</button>
            <button onclick="setSubMode('power')">Potencia</button>
            <button onclick="setSubMode('current')">Corriente</button>
            <button onclick="setSubMode('voltage')">Voltaje</button>
        </div>
    </div>

    <div id="advancedModeDropdown" class="dropdown" style="display: none;">
        <button onclick="toggleDropdown('advancedSubModeDropdown')" class="dropbtn">Submodo: <span id="currentAdvancedSubMode">Capacitancia</span></button>
        <div id="advancedSubModeDropdown" class="dropdown-content">
            <button onclick="setSubMode('capacitance')">Capacitancia</button>
            <button onclick="setSubMode('inductance')">Inductancia</button>
            <button onclick="setSubMode('mixed')">Circuitos Mixtos</button>
        </div>
    </div>

    <div id="mixedModeDropdown" class="dropdown" style="display: none;">
        <button onclick="toggleDropdown('mixedSubModeDropdown')" class="dropbtn">Tipo de Circuito: <span id="currentMixedSubMode">Mixto Resistencia</span></button>
        <div id="mixedSubModeDropdown" class="dropdown-content">
            <button onclick="setMixedMode('mixed-resistance')">Mixto Resistencia</button>
            <button onclick="setMixedMode('mixed-capacitance')">Mixto Capacitancia</button>
            <button onclick="setMixedMode('mixed-inductance')">Mixto Inductancia</button>
        </div>
    </div>

    <div class="display">
        <p class="previous-value" id="previousValue"></p>
        <p class="current-value" id="currentValue">0</p>
        <p class="result-label" id="resultLabel"></p>
        <button class="button" style="position: absolute; top: 5px; right: 5px;" onclick="toggleSteps()">i</button>
        <div id="steps" class="steps"></div>
    </div>

    <div class="buttons">
        <button class="button" onclick="clearCalculator()">C</button>
        <button class="button" onclick="backspace()">←</button>
        <button class="button" onclick="handleSpecialFunction('Ω')">Ω</button>
        <button class="button" onclick="setOperation('/')">/</button>
        
        <button class="button" onclick="appendNumber('7')">7</button>
        <button class="button" onclick="appendNumber('8')">8</button>
        <button class="button" onclick="appendNumber('9')">9</button>
        <button class="button" onclick="setOperation('*')">×</button>
        
        <button class="button" onclick="appendNumber('4')">4</button>
        <button class="button" onclick="appendNumber('5')">5</button>
        <button class="button" onclick="appendNumber('6')">6</button>
        <button class="button" onclick="setOperation('-')">-</button>
        
        <button class="button" onclick="appendNumber('1')">1</button>
        <button class="button" onclick="appendNumber('2')">2</button>
        <button class="button" onclick="appendNumber('3')">3</button>
        <button class="button" onclick="setOperation('+')">+</button>
        
        <button class="button" onclick="handleSpecialFunction('F')">F</button>
        <button class="button" onclick="appendNumber('0')">0</button>
        <button class="button" onclick="appendNumber('.')">.</button>
        <button class="button" onclick="handleSpecialFunction('H')">H</button>
    </div>
    <div class="buttons" style="margin-top: 10px;">
        <button class="button" style="grid-column: span 2; width: 100%; border-radius: 30px;" onclick="calculate()">=</button>
        <button class="button" style="grid-column: span 2; width: 100%; border-radius: 30px;" onclick="handleSpecialFunction('XL')">XL</button>
    </div>
</div>

<script>
    let currentValue = '0';
    let previousValue = '';
    let operation = null;
    let shouldResetScreen = false;
    let mode = 'basic';
    let subMode = 'resistance';
    let mixedMode = 'mixed-resistance';

    function toggleDropdown(id) {
        document.getElementById(id).classList.toggle("show");
    }

    window.onclick = function(event) {
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            for (var i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }

    function setMode(newMode) {
        mode = newMode;
        document.querySelectorAll('.mode-button').forEach(button => {
            button.classList.remove('active');
        });
        event.target.classList.add('active');
        document.getElementById('basicModeDropdown').style.display = newMode === 'basic' ? 'block' : 'none';
        document.getElementById('advancedModeDropdown').style.display = newMode === 'advanced' ? 'block' : 'none';
        document.getElementById('mixedModeDropdown').style.display = 'none';
        updateInstructions();
    }

    function setSubMode(newSubMode) {
        subMode = newSubMode;
        if (mode === 'basic') {
            document.getElementById('currentBasicSubMode').textContent = newSubMode.charAt(0).toUpperCase() + newSubMode.slice(1);
        } else {
            document.getElementById('currentAdvancedSubMode').textContent = newSubMode.charAt(0).toUpperCase() + newSubMode.slice(1);
            document.getElementById('mixedModeDropdown').style.display = newSubMode === 'mixed' ? 'block' : 'none';
        }
        updateInstructions();
    }

    function setMixedMode(newMixedMode) {
        mixedMode = newMixedMode;
        document.getElementById('currentMixedSubMode').textContent = newMixedMode.split('-')[1].charAt(0).toUpperCase() + newMixedMode.split('-')[1].slice(1);
        updateInstructions();
    }

    function updateInstructions() {
        let instructions = '';
        switch (subMode) {
            case 'resistance':
                instructions = 'Para calcular la resistencia (R), ingrese el voltaje (V) y la corriente (I). Use la fórmula: R = V / I';
                break;
            case 'power':
                instructions = 'Para calcular la potencia (P), ingrese el voltaje (V) y la corriente (I). Use la fórmula: P = V × I';
                break;
            case 'current':
                instructions = 'Para calcular la corriente (I), ingrese el voltaje (V) y la resistencia (R). Use la fórmula: I = V / R';
                break;
            case 'voltage':
                instructions = 'Para calcular el voltaje (V), ingrese la corriente (I) y la resistencia (R). Use la fórmula: V = I × R';
                break;
            case 'capacitance':
                instructions = 'Para calcular la capacitancia (C), ingrese la carga (Q) y el voltaje (V). Use la fórmula: C = Q / V';
                break;
            case 'inductance':
                instructions = 'Para calcular la inductancia (L), ingrese el voltaje (V) y la tasa de cambio de la corriente (di/dt). Use la fórmula: L = V / (di/dt)';
                break;
            case 'mixed':
                switch (mixedMode) {
                    case 'mixed-resistance':
                        instructions = 'Cálculo de resistencias en paralelo y serie:\n\n' +
                            'En paralelo: 1/Rt = 1/R1 + 1/R2 + ...\n' +
                            '1. Calcular 1/R para cada resistencia\n' +
                            '2. Sumar todos los valores\n' +
                            '3. Calcular 1 / (suma total)\n\n' +
                            'En serie: Rt = R1 + R2 + ...\n' +
                            '1. Sumar directamente todas las resistencias';
                        break;
                    case 'mixed-capacitance':
                        instructions = 'Cálculo de capacitancias en serie y paralelo:\n\n' +
                            'En serie: 1/Ct = 1/C1 + 1/C2 + ...\n' +
                            '1. Calcular 1/C para cada capacitancia\n' +
                            '2. Sumar todos los valores\n' +
                            '3. Calcular 1 / (suma total)\n\n' 'En paralelo: Ct = C1 + C2 + ...\n' +
                            '1. Sumar directamente todas las capacitancias';
                        break;
                    case 'mixed-inductance':
                        instructions = 'Cálculo de inductancias en paralelo y serie:\n\n' +
                            'En paralelo: 1/Lt = 1/L1 + 1/L2 + ...\n' +
                            '1. Calcular 1/L para cada inductancia\n' +
                            '2. Sumar todos los valores\n' +
                            '3. Calcular 1 / (suma total)\n\n' +
                            'En serie: Lt = L1 + L2 + ...\n' +
                            '1. Sumar directamente todas las inductancias';
                        break;
                }
                break;
        }
        document.getElementById('steps').innerHTML = instructions;
    }

    function updateDisplay() {
        document.getElementById('currentValue').textContent = Number(currentValue).toLocaleString('en-US', {
            maximumFractionDigits: 8,
            minimumFractionDigits: 0
        });
        document.getElementById('previousValue').textContent = previousValue;
    }

    function appendNumber(number) {
        if (shouldResetScreen) {
            currentValue = '';
            shouldResetScreen = false;
        }
        if (number === '.' && currentValue.includes('.')) return;
        if (currentValue === '0' && number !== '.') {
            currentValue = number;
        } else {
            currentValue += number;
        }
        updateDisplay();
    }

    function clearCalculator() {
        currentValue = '0';
        previousValue = '';
        operation = null;
        document.getElementById('resultLabel').textContent = '';
        document.getElementById('steps').innerHTML = '';
        updateDisplay();
    }

    function backspace() {
        if (currentValue.length === 1) {
            currentValue = '0';
        } else {
            currentValue = currentValue.slice(0, -1);
        }
        updateDisplay();
    }

    function setOperation(op) {
        if (operation !== null) calculate();
        previousValue = currentValue;
        operation = op;
        shouldResetScreen = true;
        updateDisplay();
    }

    function handleSpecialFunction(symbol) {
        const value = parseFloat(currentValue);
        let result;
        let steps = '';

        switch (subMode) {
            case 'mixed':
                if (!previousValue) {
                    previousValue = currentValue;
                    shouldResetScreen = true;
                    updateDisplay();
                    return;
                }
                const component1 = parseFloat(previousValue);
                const component2 = parseFloat(currentValue);
                switch (mixedMode) {
                    case 'mixed-resistance':
                        result = 1 / ((1 / component1) + (1 / component2));
                        steps = `Paso 1: Calcular 1/R1 = 1/${component1} = ${(1/component1).toFixed(6)}\n`;
                        steps += `Paso 2: Calcular 1/R2 = 1/${component2} = ${(1/component2).toFixed(6)}\n`;
                        steps += `Paso 3: Sumar 1/R1 + 1/R2 = ${((1/component1) + (1/component2)).toFixed(6)}\n`;
                        steps += `Paso 4: Calcular 1 / (1/R1 + 1/R2) = ${result.toFixed(6)} Ω`;
                        document.getElementById('resultLabel').textContent = 'Resistencia paralelo';
                        break;
                    case 'mixed-capacitance':
                        result = 1 / ((1 / component1) + (1 / component2));
                        steps = `Paso 1: Calcular 1/C1 = 1/${component1} = ${(1/component1).toFixed(6)}\n`;
                        steps += `Paso 2: Calcular 1/C2 = 1/${component2} = ${(1/component2).toFixed(6)}\n`;
                        steps += `Paso 3: Sumar 1/C1 + 1/C2 = ${((1/component1) + (1/component2)).toFixed(6)}\n`;
                        steps += `Paso 4: Calcular 1 / (1/C1 + 1/C2) = ${result.toFixed(6)} F`;
                        document.getElementById('resultLabel').textContent = 'Capacitancia serie';
                        break;
                    case 'mixed-inductance':
                        result = 1 / ((1 / component1) + (1 / component2));
                        steps = `Paso 1: Calcular 1/L1 = 1/${component1} = ${(1/component1).toFixed(6)}\n`;
                        steps += `Paso 2: Calcular 1/L2 = 1/${component2} = ${(1/component2).toFixed(6)}\n`;
                        steps += `Paso 3: Sumar 1/L1 + 1/L2 = ${((1/component1) + (1/component2)).toFixed(6)}\n`;
                        steps += `Paso 4: Calcular 1 / (1/L1 + 1/L2) = ${result.toFixed(6)} H`;
                        document.getElementById('resultLabel').textContent = 'Inductancia paralelo';
                        break;
                }
                break;
            case 'capacitance':
                if (symbol === 'F') {
                    result = value;
                    steps = `Capacitancia ingresada: ${result.toFixed(6)} F`;
                    document.getElementById('resultLabel').textContent = 'Capacitancia';
                }
                break;
            case 'inductance':
                if (symbol === 'H') {
                    result = value;
                    steps = `Inductancia ingresada: ${result.toFixed(6)} H`;
                    document.getElementById('resultLabel').textContent = 'Inductancia';
                } else if (symbol === 'XL') {
                    result = 2 * Math.PI * 60 * value; // Asumiendo frecuencia de 60 Hz
                    steps = `Paso 1: XL = 2 × π × f × L\n`;
                    steps += `Paso 2: XL = 2 × π × 60 × ${value} = ${result.toFixed(6)} Ω`;
                    document.getElementById('resultLabel').textContent = 'Reactancia inductiva';
                }
                break;
            default:
                return;
        }

        if (result !== undefined) {
            currentValue = result.toString();
            previousValue = '';
            operation = null;
            updateDisplay();
            document.getElementById('steps').innerHTML = steps;
        }
    }

    function calculate() {
        if (operation === null) return;

        const prev = parseFloat(previousValue);
        const current = parseFloat(currentValue);
        let result;
        let steps = '';

        switch (subMode) {
            case 'resistance':
                result = prev / current;
                steps = `Paso 1: R = V / I\n`;
                steps += `Paso 2: R = ${prev} / ${current} = ${result.toFixed(6)} Ω`;
                document.getElementById('resultLabel').textContent = 'Resistencia';
                break;
            case 'power':
                result = prev * current;
                steps = `Paso 1: P = V × I\n`;
                steps += `Paso 2: P = ${prev} × ${current} = ${result.toFixed(6)} W`;
                document.getElementById('resultLabel').textContent = 'Potencia';
                break;
            case 'current':
                result = prev / current;
                steps = `Paso 1: I = V / R\n`;
                steps += `Paso 2: I = ${prev} / ${current} = ${result.toFixed(6)} A`;
                document.getElementById('resultLabel').textContent = 'Corriente';
                break;
            case 'voltage':
                result = prev * current;
                steps = `Paso 1: V = I × R\n`;
                steps += `Paso 2: V = ${prev} × ${current} = ${result.toFixed(6)} V`;
                document.getElementById('resultLabel').textContent = 'Voltaje';
                break;
            default:
                switch (operation) {
                    case '+':
                        result = prev + current;
                        steps = `${prev} + ${current} = ${result.toFixed(6)}`;
                        break;
                    case '-':
                        result = prev - current;
                        steps = `${prev} - ${current} = ${result.toFixed(6)}`;
                        break;
                    case '*':
                        result = prev * current;
                        steps = `${prev} × ${current} = ${result.toFixed(6)}`;
                        break;
                    case '/':
                        result = prev / current;
                        steps = `${prev} ÷ ${current} = ${result.toFixed(6)}`;
                        break;
                    default:
                        return;
                }
                document.getElementById('resultLabel').textContent = 'Resultado';
        }

        currentValue = result.toString();
        previousValue = '';
        operation = null;
        shouldResetScreen = true;
        updateDisplay();
        document.getElementById('steps').innerHTML = steps;
    }

    function toggleSteps() {
        const stepsElement = document.getElementById('steps');
        stepsElement.style.display = stepsElement.style.display === 'none' ? 'block' : 'none';
    }

    // Inicialización
    updateDisplay();
    updateInstructions();
</script>
</body>
</html>